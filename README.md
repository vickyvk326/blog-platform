# Notes

### Follow this setup

---

## 1. Next.js

ðŸ“– https://nextjs.org/docs

### 1.1 Initialize Next.js app

```bash
npx create-next-app@latest blog-platform
```

- Initialises required files with default template

### 1.2 Install NextAuth + Prisma adapter

#### 1.2.1 next-auth

```bash
npm install next-auth
```

- Authentication library for Next.js.
- Handles:
  - Sign-in, sign-out
  - Session management
  - OAuth providers (Google, GitHub, etc.)
  - Credentials (email + password)

#### 1.2.2 @auth/prisma-adapter

```bash
npm install @auth/prisma-adapter
```

- An adapter that connects NextAuth with Prisma.
- Without it, NextAuth stores session & user data in memory (not persistent).
- With this, NextAuth stores sessions, users, accounts, etc. in your MySQL DB (via Prisma).
- It automatically manages tables like:
  - User
  - Account (for OAuth)
  - Session
  - VerificationToken

---

## 2. shadcn/ui

ðŸ“– https://ui.shadcn.com/docs/

### 2.1 Initialize shadcn/ui

```bash
npx shadcn@latest init
```

- Initialises required shadcn files

---

## 3. Prisma + MySQL

ðŸ“– https://www.prisma.io/docs/guides/nextjs

### 3.1 Prisma ORM

- Install prisma cli, prisma client, and mysql2
- Create an env file with database url
- Create a scheme file at prisma/schema.prisma
- Migrate prisma db

#### 3.1.1 Prisma CLI setup

```bash
npm install prisma tsx --save-dev
```

- Dev-only tool (CLI + migrations).
- You use it for:
  - Initializing Prisma â†’ `npx prisma init`
  - Defining your DB schema in `schema.prisma`
  - Running migrations â†’ `npx prisma migrate dev`
  - Generating the Prisma Client

#### 3.1.2 Prisma Client setup

```bash
npm install @prisma/client
```

- Auto-generated client library to talk to your database.
- Generated by Prisma based on your `schema.prisma`.

### 3.2 MySQL driver setup

```bash
npm install mysql2
```

- A low-level MySQL driver for Node.js.
- Prisma uses it under the hood to connect to MySQL.
- You donâ€™t use it directly â€” but Prisma needs it to talk to your MySQL DB.
- Without this, Prisma cannot connect to your DB.

### 3.3 Migrate prisma DB

```bash
npx prisma migrate dev
```

- Looks at your current prisma/schema.prisma file (the source of truth).
- Compares it with the database schema.
- Creates a new migration file inside the prisma/migrations/ folder if there are changes.
- Applies that migration to your local database.
- Regenerates the Prisma Client (@prisma/client) so your code can use the new schema immediately.

### 3.4 View DB via GUI

```bash
npx prisma generate
npx prisma studio
```

Shows DB tables in http://localhost:5555

---

## 3.3 Prisma Annotations Cheat Sheet

### 3.3.1 Primary Key & Defaults

| Attribute                   | Example                                | Meaning                        |
| --------------------------- | -------------------------------------- | ------------------------------ |
| `@id`                       | `id Int @id`                           | Marks field as **primary key** |
| `@default(autoincrement())` | `id Int @id @default(autoincrement())` | Auto-incrementing IDs          |
| `@default(now())`           | `createdAt DateTime @default(now())`   | Default = current timestamp    |
| `@updatedAt`                | `updatedAt DateTime @updatedAt`        | Auto-updates on row changes    |
| `@default("draft")`         | `status String @default("draft")`      | Default string value           |
| `@default(false)`           | `published Boolean @default(false)`    | Default boolean                |

---

### 3.3.2 Relations

| Attribute                                 | Example                                                                        | Meaning                                           |
| ----------------------------------------- | ------------------------------------------------------------------------------ | ------------------------------------------------- |
| `@relation(fields: [x], references: [y])` | `author User @relation(fields: [authorId], references: [id])` + `authorId Int` | Defines a **foreign key**                         |
| Implicit relation                         | `posts Post[]` inside `User`                                                   | One-to-many relation without explicit foreign key |

---

### 3.3.3 Constraints & Indexes

| Attribute                    | Example                | Meaning                                     |
| ---------------------------- | ---------------------- | ------------------------------------------- |
| `@unique`                    | `email String @unique` | Unique constraint on column                 |
| `@@unique([userId, postId])` | Inside `Like` model    | Composite unique (prevents duplicate likes) |
| `@@id([field1, field2])`     |                        | Composite primary key                       |
| `@@index([field])`           |                        | Creates index for faster lookups            |

---

### 3.3.4 Mapping & Customization

| Attribute           | Example                             | Meaning                              |
| ------------------- | ----------------------------------- | ------------------------------------ |
| `@map("db_column")` | `fullName String @map("full_name")` | Maps Prisma field â†’ DB column name   |
| `@@map("db_table")` | `@@map("users")`                    | Maps model â†’ DB table name           |
| `@ignore`           | `legacyField String @ignore`        | Field ignored in migrations & client |
| `@db.VarChar(50)`   | `title String @db.VarChar(50)`      | Sets DB column type explicitly       |

---

### 3.3.5 Extras

| Attribute                 | Example                          | Meaning                                            |
| ------------------------- | -------------------------------- | -------------------------------------------------- |
| `@default(uuid())`        | `id String @id @default(uuid())` | Auto-generate UUID                                 |
| `@default(cuid())`        | `id String @id @default(cuid())` | Generate globally unique ID                        |
| `@relation("CustomName")` |                                  | Name relations explicitly (useful in many-to-many) |

https://localhost:3000/verify?token=4fd24271-e7c0-4438-a552-6ff03d5fa558